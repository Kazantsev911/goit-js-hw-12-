{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nexport const list = document.querySelector('.js-gallery');\nexport const loadMoreBtn = document.querySelector('.js-load-more');\nexport const loader = document.querySelector('.js-loader-container');\n\nexport function createMarkup(arr) {\n  const markup = arr\n    .map(\n      ({\n        largeImageURL,\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `<li class=\"gallery-item js-gallery-item\">\n\t<a class=\"gallery-link js-gallery-link\" href=\"${largeImageURL}\">\n\t\t<img \n\t\t\tclass=\"gallery-image js-gallery-image\" \n\t\t\tsrc=\"${webformatURL}\" \n\t\t\talt=\"${tags}\" \n\t\t\t/>\n\t</a>\n    <ul class=\"inform-container\">\n    <li class=\"inform-item\">\n    <h3 class=\"inform-title\">Likes</h3>\n    <p>${likes}</p>\n    </li>\n    <li class=\"inform-item\">\n    <h3 class=\"inform-title\">Views</h3>\n    <p>${views}</p>\n    </li>\n    <li class=\"inform-item\">\n    <h3 class=\"inform-title\">Comments</h3>\n    <p>${comments}</p>\n    </li>\n    <li class=\"inform-item\">\n    <h3 class=\"inform-title\">Downloads</h3>\n    <p>${downloads}</p>\n    </li>\n    </ul>\n</li>`\n    )\n    .join('');\n\n  list.insertAdjacentHTML('beforeend', markup);\n}\n\nexport function showError(err) {\n  return iziToast.error({\n    message:\n      'Sorry, there are no images matching your search query. Please try again!',\n    backgroundColor: '#ef4040',\n    maxWidth: 432,\n    timeout: 3000,\n    messageColor: '#fafafb',\n    messageSize: '16',\n    theme: 'dark',\n    progressBarColor: '#b51b1',\n    position: 'topRight',\n  });\n}\n\nexport const lightbox = new SimpleLightbox('.js-gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n  scrollZoom: false,\n});\n\nlightbox.on('show.simplelightbox', function () {});\n\nexport const showEndOfResultsMessage = () => {\n  iziToast.warning({\n    message: 'We are sorry, but you have reached the end of search results.',\n    backgroundColor: '#ef6c40',\n    maxWidth: 432,\n    timeout: 3000,\n    messageColor: 'ef6c40',\n    messageSize: '16',\n    theme: 'dark',\n    progressBarColor: '#ab360e',\n    position: 'topRight',\n  });\n};\n\nexport const toggleLoadMoreButton = show => {\n  if (show) {\n    loadMoreBtn.classList.remove('hidden');\n  } else {\n    loadMoreBtn.classList.add('hidden');\n  }\n};\n\nexport const toggleLoader = show => {\n  if (show) {\n    loader.classList.remove('hidden');\n  } else {\n    loader.classList.add('hidden');\n  }\n};\n","import axios from 'axios';\n// import { q, page } from '../main.js';\n\nconst API_KEY = '25786434-348adb767e319176b4ad356ea';\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nexport async function searchImages(q, page) {\n  const params = {\n    key: API_KEY,\n    q: q,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    per_page: 15,\n    page: page,\n  };\n\n  const response = await axios.get('', { params });\n  return response.data;\n}\n","import {\n  showError,\n  createMarkup,\n  list,\n  lightbox,\n  loader,\n  toggleLoader,\n  loadMoreBtn,\n  showEndOfResultsMessage,\n  toggleLoadMoreButton,\n} from './js/render-functions';\nimport { searchImages } from './js/pixabay-api';\n\nconst form = document.querySelector('.js-search-form');\n\nlet page = 1;\nlet q = '';\nlet totalHits = 0;\n\nconst handlerAddSearch = async event => {\n  event.preventDefault();\n\n  const inputForm = event.currentTarget;\n  q = inputForm.elements.query.value.trim();\n\n  if (!q) {\n    list.innerHTML = '';\n    toggleLoadMoreButton(false);\n    return showError();\n  }\n  page = 1;\n  list.innerHTML = '';\n\n  toggleLoadMoreButton(false);\n  toggleLoader(true);\n\n  try {\n    const { hits, totalHits } = await searchImages(q, page);\n    if (hits.length === 0) {\n      toggleLoader(false);\n      return showError('No images found. Please try another search term.');\n    }\n    createMarkup(hits);\n    lightbox.refresh();\n    if (totalHits > hits.length) {\n      toggleLoadMoreButton(true);\n    }\n  } catch (error) {\n    showError('An error occurred while fetching images.');\n    console.error(error);\n  } finally {\n    toggleLoader(false);\n  }\n\n  inputForm.reset();\n};\n\nconst fetchImages = async (q, page) => {\n  const data = await searchImages(q, page);\n  if (data.hits.length === 0) {\n    list.innerHTML = '';\n    throw new Error('No images found');\n  }\n  totalHits = data.totalHits;\n  return data;\n};\n\nconst handleLoadMore = async () => {\n  page += 1;\n  toggleLoader(true);\n  toggleLoadMoreButton(false);\n\n  try {\n    const { hits } = await fetchImages(q, page);\n    createMarkup(hits);\n    lightbox.refresh();\n    const displayedImages = document.querySelectorAll('.gallery-item').length;\n    if (displayedImages < totalHits) {\n      toggleLoadMoreButton(true);\n    } else {\n      showEndOfResultsMessage();\n    }\n\n    scrollPage();\n  } catch (error) {\n    showError('An error occurred while fetching images.');\n    console.error(error);\n  } finally {\n    toggleLoader(false);\n  }\n};\n\nconst scrollPage = () => {\n  const galleryItemHeight = document\n    .querySelector('.gallery-item')\n    .getBoundingClientRect().height;\n  window.scrollBy({\n    top: galleryItemHeight * 2,\n    behavior: 'smooth',\n  });\n};\n\nform.addEventListener('submit', handlerAddSearch);\nloadMoreBtn.addEventListener('click', handleLoadMore);\n"],"names":["list","loadMoreBtn","loader","createMarkup","arr","markup","largeImageURL","webformatURL","tags","likes","views","comments","downloads","showError","err","iziToast","lightbox","SimpleLightbox","showEndOfResultsMessage","toggleLoadMoreButton","show","toggleLoader","API_KEY","axios","searchImages","q","page","params","form","totalHits","handlerAddSearch","event","inputForm","hits","error","fetchImages","data","handleLoadMore","scrollPage","galleryItemHeight"],"mappings":"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"}